# Frontend Guide

Learn how the RISE Vibe Kit frontend is structured and how to use its powerful features.

## 🏗️ Project Structure

```
frontend/
├── src/
│   ├── app/              # Next.js 13 app directory
│   │   ├── layout.tsx    # Root layout with providers
│   │   ├── page.tsx      # Home page
│   │   └── [feature]/    # Feature pages (chat, pump, etc.)
│   ├── components/       # Reusable UI components
│   ├── hooks/           # Custom React hooks
│   ├── lib/             # Utilities and clients
│   ├── providers/       # React context providers
│   └── contracts/       # Auto-generated contract data
├── public/              # Static assets
└── package.json
```

## 🪝 Hooks: The Power of RISE

### Core Hooks

#### `useContract(contractName)`
Read and write to contracts with automatic type safety:

```typescript
const { read, write, isLoading } = useContract('ChatApp');

// Read data
const message = await read('getMessage', [messageId]);

// Write data (instant with embedded wallet!)
const receipt = await write('sendMessage', ['Hello RISE!']);
```

#### `useContractEvents(contractName)`
Subscribe to real-time contract events:

```typescript
const events = useContractEvents('ChatApp');

// Events update automatically via WebSocket
events.forEach(event => {
  if (event.eventName === 'MessageSent') {
    console.log('New message:', event.args.content);
  }
});
```

#### `useEmbeddedWallet()`
Manage the browser-based wallet:

```typescript
const { address, balance, isConnected } = useEmbeddedWallet();
```

### Creating Custom Hooks

Follow this pattern for your own contracts:

```typescript
// hooks/useMyContract.ts
import { createContractHook } from '@/hooks/useContractFactory';
import { useContractEvents } from '@/hooks/useContractEvents';

const useMyContractBase = createContractHook('MyContract');

export function useMyContract() {
  const contract = useMyContractBase();
  const events = useContractEvents('MyContract');
  
  // Add custom methods
  const doSomething = async () => {
    return await contract.write('someMethod', [arg1, arg2]);
  };
  
  return {
    ...contract,
    events,
    doSomething
  };
}
```

## 🎨 Components

### Key Components

- **`WalletSelector`** - Connect wallet UI (embedded or external)
- **`TransactionConfirmation`** - Shows instant TX feedback
- **`EventNotifications`** - Real-time event toasts
- **`WebSocketStatus`** - Connection indicator

### Component Patterns

```tsx
// Real-time UI updates
function MyComponent() {
  const { events } = useContractEvents('MyContract');
  const [items, setItems] = useState([]);
  
  useEffect(() => {
    // Update UI when events arrive
    const latestEvent = events[events.length - 1];
    if (latestEvent?.eventName === 'ItemAdded') {
      setItems(prev => [...prev, latestEvent.args]);
    }
  }, [events]);
  
  return <ItemList items={items} />;
}
```

## 🔄 Providers

### WebSocketProvider
Manages the WebSocket connection for real-time events:

```tsx
// Automatically included in root layout
<WebSocketProvider>
  <App />
</WebSocketProvider>
```

### AutoWalletProvider
Handles embedded wallet initialization:

```tsx
// Creates/loads wallet on first visit
<AutoWalletProvider>
  <App />
</AutoWalletProvider>
```

## 📁 Auto-generated Files

### contracts/contracts.ts
Generated by `npm run deploy-and-sync`:

```typescript
export const contracts = {
  ChatApp: {
    address: '0x...',
    abi: [...],
    deploymentTxHash: '0x...'
  }
};
```

Never edit this file manually!

## 🛠️ Development Workflow

1. **Hot Reload** - Changes reflect instantly
2. **Type Safety** - Full TypeScript support
3. **Error Handling** - Built-in error boundaries
4. **State Management** - React Query for caching

## 💡 Best Practices

### 1. Use the Provided Hooks
Don't reinvent the wheel:
```typescript
// ✅ Good
const { write } = useContract('MyContract');

// ❌ Avoid
const provider = new ethers.providers.JsonRpcProvider();
```

### 2. Handle Loading States
```tsx
const { isLoading, write } = useContract('MyContract');

<Button disabled={isLoading} onClick={() => write('method')}>
  {isLoading ? 'Processing...' : 'Submit'}
</Button>
```

### 3. Subscribe to Events Early
```typescript
// In your component
useEffect(() => {
  // Events start streaming immediately
  console.log('Subscribed to contract events');
}, []);
```

### 4. Use Instant Feedback
```typescript
const receipt = await write('transfer', [recipient, amount]);
// Update UI immediately - no waiting!
setBalance(prev => prev - amount);
```

## 🎯 Common Patterns

### Real-time List Updates
See `frontend/src/app/chat/page.tsx` for a complete example:

```typescript
const messages = events
  .filter(e => e.eventName === 'MessageSent')
  .map(e => e.args);
```

### Optimistic Updates
```typescript
// Update UI before transaction
setItems([...items, newItem]);

// Send transaction (instant confirmation)
await write('addItem', [newItem]);
```

### Event-Driven State
```typescript
// State updates from events, not polling
useEffect(() => {
  const handleEvent = (event) => {
    setState(event.args.newState);
  };
  
  // WebSocket handles subscription
}, [events]);
```

Ready to build? Check out the [Tutorial](./tutorial.md) for a complete walkthrough!